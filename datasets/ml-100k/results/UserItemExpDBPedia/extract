#!/usr/bin/python

import sys
import os
import subprocess
from time import gmtime, strftime, localtime
from datetime import datetime

for alg in os.listdir("."):
    if "MRMR" in alg: 
        if not os.path.exists("./"+alg+"/summaries/"):
	        os.makedirs("./"+alg+"/summaries/")
        for given in os.listdir("./"+alg):
	        if "given" in given: 
		        #for top in os.listdir(given):
		        #with open("./summaries/"+given+".summary", "a") as myfile:
            	#		myfile.write("\nResult "+top+"\n")
		        #cmd = "cat ./"+given+"/"+top+"/"+"metrics.complete"
		        #cmd += " >> ./summaries/"+given+".summary"
		        #subprocess.call(cmd, shell=True)
#		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
#            			myfile.write("\nResult Top 5 \n")
#		        cmd = "cat ./"+alg+"/"+given+"/top_5/"+"metrics.complete"
#		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
#		        subprocess.call(cmd, shell=True)
#		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
#            			myfile.write("\nResult Top 10 \n")
#		        cmd = "cat ./"+alg+"/"+given+"/top_10/"+"metrics.complete"
#		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
#		        subprocess.call(cmd, shell=True)
#		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
#            			myfile.write("\nResult Top 15 \n")
#		        cmd = "cat ./"+alg+"/"+given+"/top_15/"+"metrics.complete"
#		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
#		        subprocess.call(cmd, shell=True)
#		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
#            			myfile.write("\nResult Top 20 \n")
#		        cmd = "cat ./"+alg+"/"+given+"/top_20/"+"metrics.complete"
#		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
#		        subprocess.call(cmd, shell=True)
#		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
#            			myfile.write("\nResult Top 30 \n")
#		        cmd = "cat ./"+alg+"/"+given+"/top_30/"+"metrics.complete"
#		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
#		        subprocess.call(cmd, shell=True)
		        with open("./"+alg+"/summaries/"+given+".summary", "a") as myfile:
            			myfile.write("\nResult Top 50 \n")
		        cmd = "cat ./"+alg+"/"+given+"/top_50/"+"metrics.complete"
		        cmd += " >> ./"+alg+"/summaries/"+given+".summary"
		        subprocess.call(cmd, shell=True)    

        metrics=["P","recall","F1"]
        for metric in metrics:
            valor=["5","10","15","20","30","50"]
            for elem in valor:
                cmd = "grep \""+metric+"_"+elem+"=\" ./"+alg+"/summaries/*.summary >> ./"+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\./"+alg+"/summaries/given_\ \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\.summary:"+metric+"_"+elem+"=\ \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\all\\100\ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 0.\\ 0,\ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 5 \\005 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 10 \\010 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 20 \\020 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 30 \\030 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 50 \\050 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\ 100 \\100 \ ' "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sort "+alg+"/summaries/res"+metric+elem+".sum > "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)
                cmd ="rm "+alg+"/summaries/res"+metric+elem+".sum"
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\005 \\5 \ ' "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\010 \\10 \ ' "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\020 \\20 \ ' "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\030 \\30 \ ' "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)
                cmd ="sed -i 's\\050 \\50 \ ' "+alg+"/summaries/result"+metric+elem
                subprocess.call(cmd, shell=True)

